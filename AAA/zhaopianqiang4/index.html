<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D图片相册</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <style>
        html, body, .stage, .ring, .img {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            user-select: none;
        }

        html, body,
        .stage {
          overflow: hidden;
          background: #000;
        }
        div, svg {
          position: absolute;
        }

        .container {
          perspective: 2000px;
          width: 300px;
          height: 400px;
          left: 50%;
          top: 50%;
          transform: translate(-50%, -50%);
        }
        
        /* 添加图片样式 */
        .img img {
            width: 100%; /* 图片宽度占满容器 */
            height: 100%; /* 图片高度占满容器 */
            object-fit: cover; /* 保持图片比例，裁剪超出部分 */
            border-radius: 5px; /* 圆角效果 */
            cursor: pointer; /* 添加指针效果 */
            transition: transform 0.3s ease; /* 添加过渡效果 */
        }
        
        /* 调整容器尺寸以适应图片 */
        @media (max-width: 600px) {
            .container {
                width: 250px;
                height: 350px;
            }
        }
        
        /* 图片放大查看器样式 */
        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
        }
        
        .image-viewer img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            animation: zoomIn 0.3s ease;
        }
        
        /* 关闭按钮样式 */
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .close-btn:hover {
            transform: scale(1.2);
        }
        
        /* 动画效果 */
        @keyframes zoomIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="stage">
        <div class="container">
            <div class="ring">
                <div class="img"><img src="../zhaopianqiang4/images/1.png" alt="图片1"></div>
                <div class="img"><img src="../zhaopianqiang4/images/2.png" alt="图片2"></div>
                <div class="img"><img src="../zhaopianqiang4/images/3.png" alt="图片3"></div>
                <div class="img"><img src="../zhaopianqiang4/images/4.png" alt="图片4"></div>
                <div class="img"><img src="../zhaopianqiang4/images/5.png" alt="图片5"></div>
                <div class="img"><img src="../zhaopianqiang4/images/6.png" alt="图片6"></div>
                <div class="img"><img src="../zhaopianqiang4/images/7.png" alt="图片7"></div>
                <div class="img"><img src="../zhaopianqiang4/images/8.png" alt="图片8"></div>
                <div class="img"><img src="../zhaopianqiang4/images/9.png" alt="图片9"></div>
                <div class="img"><img src="../zhaopianqiang4/images/10.png" alt="图片10"></div>
            </div>
        </div>
    </div>
    
    <!-- 图片放大查看器 -->
    <div class="image-viewer">
        <img id="viewer-image" src="" alt="放大图片">
        <div class="close-btn">&times;</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/gsap.min.js"></script>
    <script>
        let xPos = 0;
        const imageViewer = document.querySelector('.image-viewer');
        const viewerImage = document.getElementById('viewer-image');
        const closeBtn = document.querySelector('.close-btn');
        
        // 自动旋转配置
        let autoRotateInterval = 1000; // 自动旋转间隔时间（毫秒）
        let autoRotateTimer = null;
        let isAutoRotating = true;
        let currentRotation = 180; // 当前旋转角度
        const totalImages = 10; // 图片总数
        const rotationStep = 36; // 每次旋转的角度（360度 / 10张图片）
        
        // 自动旋转功能
        function startAutoRotate() {
            if (autoRotateTimer) {
                clearInterval(autoRotateTimer);
            }
            
            autoRotateTimer = setInterval(() => {
                if (isAutoRotating) {
                    currentRotation -= rotationStep; // 逆时针旋转
                    gsap.to('.ring', {
                        rotationY: currentRotation,
                        duration: 1,
                        ease: 'power2.inOut'
                    });
                }
            }, autoRotateInterval);
        }
        
        // 停止自动旋转
        function stopAutoRotate() {
            if (autoRotateTimer) {
                clearInterval(autoRotateTimer);
                autoRotateTimer = null;
            }
        }
        
        // 暂停自动旋转
        function pauseAutoRotate() {
            isAutoRotating = false;
        }
        
        // 恢复自动旋转
        function resumeAutoRotate() {
            isAutoRotating = true;
        }
        
        // 设置自动旋转间隔时间
        function setAutoRotateInterval(interval) {
            autoRotateInterval = interval;
            if (autoRotateTimer) {
                stopAutoRotate();
                startAutoRotate();
            }
        }

        gsap.timeline()
            .set('.ring', { rotationY: 180, cursor: 'grab' })
            .set('.img', {
                rotateY: (i) => i * -36,
                transformOrigin: '50% 50% 500px',
                z: -500,
                backfaceVisibility: 'hidden'
            })
            .from('.img', {
                duration: 1.5,
                y: 200,
                opacity: 0,
                stagger: 0.1,
                ease: 'expo'
            })
            .add(() => {
                document.querySelectorAll('.img').forEach(img => {
                    img.addEventListener('mouseenter', (e) => {
                        let current = e.currentTarget;
                        gsap.to('.img', { opacity: (i, t) => (t == current) ? 1 : 0.5, ease: 'power3' });
                        // 鼠标悬停时暂停自动旋转
                        pauseAutoRotate();
                    });

                    img.addEventListener('mouseleave', (e) => {
                        gsap.to('.img', { opacity: 1, ease: 'power2.inOut' });
                        // 鼠标离开时恢复自动旋转
                        resumeAutoRotate();
                    });
                    
                    // 为每个图片添加点击事件
                    img.querySelector('img').addEventListener('click', (e) => {
                        // 阻止事件冒泡，避免触发容器的点击事件
                        e.stopPropagation();
                        // 显示图片查看器
                        viewerImage.src = e.currentTarget.src;
                        imageViewer.style.display = 'flex';
                        // 隐藏滚动条
                        document.body.style.overflow = 'hidden';
                    });
                });
                
                // 启动自动旋转
                startAutoRotate();
            }, '-=0.5');

        document.addEventListener('mousedown', dragStart);
        document.addEventListener('touchstart', dragStart);

        function dragStart(e) {
            if (e.touches) e.clientX = e.touches[0].clientX;
            xPos = Math.round(e.clientX);
            gsap.set('.ring', { cursor: 'grabbing' });
            // 拖拽开始时暂停自动旋转
            pauseAutoRotate();
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
        }

        function drag(e) {
            if (e.touches) e.clientX = e.touches[0].clientX;
            const deltaX = (Math.round(e.clientX) - xPos) % 360;
            gsap.to('.ring', {
                rotationY: '-=' + deltaX,
                onUpdate: () => {
                    // 更新当前旋转角度
                    currentRotation = gsap.getProperty('.ring', 'rotationY');
                    // 更新图片位置
                    document.querySelectorAll('.img img').forEach((img, i) => {
                        const bgPos = (100 - gsap.utils.wrap(0, 360, currentRotation - 180 - i * 36) / 360 * 500) + 'px 0px';
                        // 这里可以根据需要调整图片位置
                    });
                }
            });

            xPos = Math.round(e.clientX);
        }

        document.addEventListener('mouseup', dragEnd);
        document.addEventListener('touchend', dragEnd);

        function dragEnd(e) {
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('touchmove', drag);
            gsap.set('.ring', { cursor: 'grab' });
            // 拖拽结束后恢复自动旋转
            setTimeout(() => {
                resumeAutoRotate();
            }, 1000); // 延迟1秒后恢复自动旋转
        }
        
        // 关闭图片查看器
        function closeViewer() {
            imageViewer.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // 点击关闭按钮关闭查看器
        closeBtn.addEventListener('click', closeViewer);
        
        // 点击背景关闭查看器
        imageViewer.addEventListener('click', (e) => {
            if (e.target === imageViewer) {
                closeViewer();
            }
        });
        
        // 按ESC键关闭查看器
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && imageViewer.style.display === 'flex') {
                closeViewer();
            }
        });
    </script>
</body>
</html>
